---
- name: Build and deploy web server
  hosts: all
  become: true
  vars:
    app_port: 80
    app_path: /var/www/my-web-server
  tasks:
    - name: Copy web files
      copy:
        src: index.html
        dest: "{{ app_path }}/index.html"
        mode: 0755
      remote_user: lucas
      become_user: root

    - name: Start web server
      shell: "cd {{ app_path }} && python3 -m http.server {{ app_port }}"
      async: 0
      poll: 0
      remote_user: lucas
      become_user: root
